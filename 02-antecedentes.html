<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>antecedentes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="02-antecedentes_files/libs/clipboard/clipboard.min.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/quarto.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/popper.min.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02-antecedentes_files/libs/quarto-html/anchor.min.js"></script>
<link href="02-antecedentes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-antecedentes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02-antecedentes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02-antecedentes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02-antecedentes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="antecedentes" class="level1">
<h1>Antecedentes</h1>
<section id="conceptos-y-medición-de-las-preferencias-redistributivas" class="level2">
<h2 class="anchored" data-anchor-id="conceptos-y-medición-de-las-preferencias-redistributivas">Conceptos y Medición de las Preferencias Redistributivas</h2>
<p>Las preferencias redistributivas se refieren a las actitudes de los individuos hacia la asignación de recursos dentro de la sociedad, especialmente en relación con las políticas destinadas a reducir la desigualdad de ingresos a través de impuestos y programas de bienestar social. Los conceptos y la medición de estas preferencias son multifacéticos, abarcando diversos marcos teóricos y hallazgos empíricos que destacan la interacción entre las características individuales, las normas sociales y las condiciones económicas. Un aspecto significativo de las preferencias redistributivas es el papel del interés propio y la percepción de justicia. La investigación indica que los individuos a menudo basan su apoyo a la redistribución en su situación económica y en la legitimidad percibida de la distribución de la riqueza. <span class="citation" data-cites="dimick_altruistic_2017">Dimick, Rueda, and Stegmueller (<a href="#ref-dimick_altruistic_2017" role="doc-biblioref">2017</a>)</span> argumentan que los individuos distinguen entre ingresos obtenidos por “suerte” frente a “esfuerzo”, lo que influye significativamente en sus preferencias por la redistribución. De manera similar, <span class="citation" data-cites="kuziemko_elastic_2015">Kuziemko et al. (<a href="#ref-kuziemko_elastic_2015" role="doc-biblioref">2015</a>)</span> enfatizan la importancia de las preferencias de los votantes y las motivaciones subyacentes que impulsan estas preferencias, sugiriendo que el interés propio desempeña un papel crucial en la configuración de las actitudes hacia las políticas redistributivas. Esto se alinea con los hallazgos de <span class="citation" data-cites="goni_fiscal_2011">Goñi, López, and Servén (<a href="#ref-goni_fiscal_2011" role="doc-biblioref">2011</a>)</span>, quienes señalan que los factores culturales y contextuales también influyen en las preferencias redistributivas, con individuos en diferentes países exhibiendo distintos niveles de apoyo a la redistribución en función de sus normas sociales y condiciones económicas.</p>
<p>La medición de las preferencias redistributivas a menudo implica examinar la influencia de factores demográficos, como el nivel de ingresos, la educación y el capital social. <span class="citation" data-cites="mustofa_education_2023">Mustofa, Sugiyanto, and Susamto (<a href="#ref-mustofa_education_2023" role="doc-biblioref">2023</a>)</span> destacan que una educación superior puede alterar las percepciones de justicia, afectando así las preferencias por la redistribución. De manera similar, <span class="citation" data-cites="yamamura_norms_2015">Yamamura (<a href="#ref-yamamura_norms_2015" role="doc-biblioref">2015</a>)</span> discuten cómo las normas comunitarias y el capital social impactan en las actitudes de los individuos hacia la redistribución, sugiriendo que unos lazos comunitarios más fuertes pueden aumentar el apoyo a las políticas redistributivas. Esta noción se ve respaldada además por <span class="citation" data-cites="lasarga_mobility_2022">Lasarga and Leiter (<a href="#ref-lasarga_mobility_2022" role="doc-biblioref">2022</a>)</span>, quienes exploran cómo la desigualdad de ingresos y la presencia de minorías étnicas entre los pobres pueden influir en las preferencias públicas por la redistribución en América Latina. Las dinámicas de las preferencias redistributivas también están influenciadas por contextos económicos y políticos más amplios. <span class="citation" data-cites="gonthier_parallel_2016">Gonthier (<a href="#ref-gonthier_parallel_2016" role="doc-biblioref">2016</a>)</span> señala que durante las crisis económicas, las preferencias por la redistribución pueden cambiar a medida que los individuos reevalúan sus intereses materiales y valores fundamentales relacionados con la igualdad y la justicia social. Además, el concepto de “altruismo parroquial”, discutido por <span class="citation" data-cites="rueda_food_2018">Rueda (<a href="#ref-rueda_food_2018" role="doc-biblioref">2018</a>)</span>, sugiere que los individuos pueden priorizar las preferencias redistributivas basándose en su entorno social inmediato, particularmente en el contexto de la inmigración y la asignación de recursos. Esto indica que las preferencias redistributivas no son estáticas, sino que responden a los cambiantes paisajes económicos y sociales.</p>
<p>La medición de las preferencias redistributivas ha evolucionado significativamente, utilizando diversas metodologías de encuesta para capturar las actitudes de los individuos hacia la redistribución de ingresos. Las encuestas emplean distintos ítems que evalúan las preferencias por diferentes políticas redistributivas, permitiendo a los investigadores analizar cómo varían estas preferencias entre grupos demográficos y en distintos contextos económicos. Por ejemplo, <span class="citation" data-cites="brooks_redistribution_2021">Brooks and Harter (<a href="#ref-brooks_redistribution_2021" role="doc-biblioref">2021</a>)</span> llevaron a cabo un análisis exhaustivo utilizando 12 ítems distintos relacionados con las preferencias redistributivas, aprovechando datos de alta calidad de los estudios nacionales electorales Estadounidenses. Este enfoque permite una comprensión matizada de cómo el partidismo y otros factores influyen en las actitudes hacia la tributación y la redistribución. <span class="citation" data-cites="meuleman_context_2019">Meuleman (<a href="#ref-meuleman_context_2019" role="doc-biblioref">2019</a>)</span> analizaron datos de encuestas transversales repetidas del British Social Attitudes (BSA) y la General Social Survey (GSS) para desentrañar las diferencias de cohorte y año en el apoyo a la redistribución de ingresos, destacando el impacto del contexto económico predominante en estas preferencias. Además, se han empleado enfoques experimentales para evaluar la elasticidad de las preferencias por la redistribución. <span class="citation" data-cites="kuziemko_elastic_2015">Kuziemko et al. (<a href="#ref-kuziemko_elastic_2015" role="doc-biblioref">2015</a>)</span> realizaron experimentos de encuestas aleatorizadas para explorar cómo cambian las preferencias de los individuos en respuesta a cambios en las condiciones económicas percibidas y las normas sociales. Esta metodología permite una comprensión más dinámica de las preferencias redistributivas, revelando cómo los factores contextuales pueden influir significativamente en las actitudes de los individuos hacia la redistribución.</p>
<p>En el contexto de América Latina, las preferencias redistributivas están moldeadas por una combinación única de factores históricos, económicos y sociales que contribuyen a los altos niveles de desigualdad de la región. La región se ha caracterizado durante mucho tiempo por marcadas disparidades de ingresos, con un coeficiente de Gini significativamente más alto que en otras partes del mundo <span class="citation" data-cites="goni_fiscal_2011">(<a href="#ref-goni_fiscal_2011" role="doc-biblioref">Goñi, López, and Servén 2011</a>)</span>. Esta desigualdad ha influido en las actitudes públicas hacia la redistribución, observándose preferencias variables entre los distintos países. Por ejemplo, <span class="citation" data-cites="franetovic_preferences_2022">(<a href="#ref-franetovic_preferences_2022" role="doc-biblioref">Franetovic and Castillo 2022</a>)</span> destacan que las preferencias por la redistribución de ingresos en América Latina han evolucionado entre 2008 y 2018, reflejando cambios en las condiciones económicas y el sentimiento público hacia la desigualdad. Además, la percepción de la corrupción juega un papel crítico en la configuración de las preferencias redistributivas. <span class="citation" data-cites="hauk_corruption_2017">(<a href="#ref-hauk_corruption_2017" role="doc-biblioref">Hauk, Oviedo, and Ramos 2017</a>)</span> encontraron que en los países con altos niveles de corrupción percibida, el apoyo público a la redistribución tiende a ser más fuerte, ya que los ciudadanos a menudo ven la redistribución como un medio para contrarrestar los efectos negativos de la corrupción en la desigualdad económica. Esta relación subraya la complejidad de las preferencias redistributivas en la región, donde la confianza institucional y las percepciones de la eficacia gubernamental influyen significativamente en las actitudes públicas hacia las políticas redistributivas.</p>
<p>Los estudios específicos por país iluminan aún más las sutilezas de las preferencias redistributivas. Por ejemplo, Brasil ha experimentado cambios significativos en las políticas redistributivas, lo que ha contribuido a una reducción de la desigualdad de ingresos en las últimas dos décadas. Sin embargo, la persistencia de altos niveles de desigualdad indica que los sistemas redistributivos aún se están desarrollando y enfrentan numerosos desafíos <span class="citation" data-cites="lasarga_mobility_2022">(<a href="#ref-lasarga_mobility_2022" role="doc-biblioref">Lasarga and Leiter 2022</a>)</span>. En contraste, países como Argentina y Uruguay han implementado sistemas de protección social más robustos, que se han asociado con niveles más altos de apoyo público a la redistribución <span class="citation" data-cites="ocampo_social_2018">(<a href="#ref-ocampo_social_2018" role="doc-biblioref">Ocampo and Gómez-Arteaga 2018</a>)</span>. Además, no se puede pasar por alto el papel de los movimientos sociales y las protestas en la configuración de las preferencias redistributivas. <span class="citation" data-cites="justino_redistributive_2019">(<a href="#ref-justino_redistributive_2019" role="doc-biblioref">Justino and Martorano 2019</a>)</span> argumentan que fuertes preferencias redistributivas, junto con demandas insatisfechas de justicia social, han llevado a un aumento de las protestas en América Latina, destacando una desconexión entre las expectativas públicas y la acción gubernamental. Esta dinámica ilustra cómo las preferencias redistributivas no son solo un reflejo de actitudes individuales, sino que también están influenciadas por contextos sociopolíticos más amplios.</p>
</section>
<section id="preferencias-redistributivas-y-factores-asociados" class="level2">
<h2 class="anchored" data-anchor-id="preferencias-redistributivas-y-factores-asociados">Preferencias redistributivas y factores asociados</h2>
</section>
<section id="contexto-y-cambio-de-preferencias-en-américa-latina" class="level2 unnumbered">


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Contexto y cambio de preferencias en América Latina</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-brooks_redistribution_2021" class="csl-entry" role="listitem">
Brooks, Clem, and Eric Harter. 2021. <span>“Redistribution Preferences, Inequality Information, and Partisan Motivated Reasoning in the United States.”</span> <em>Societies</em> 11 (2): 65. <a href="https://doi.org/10.3390/soc11020065">https://doi.org/10.3390/soc11020065</a>.
</div>
<div id="ref-dimick_altruistic_2017" class="csl-entry" role="listitem">
Dimick, Matthew, David Rueda, and Daniel Stegmueller. 2017. <span>“The Altruistic Rich? <span>Inequality</span> and Other-Regarding Preferences for Redistribution.”</span> <em>Quarterly Journal of Political Science</em> 11 (4): 385–439. <a href="https://doi.org/10.1561/100.00015099">https://doi.org/10.1561/100.00015099</a>.
</div>
<div id="ref-franetovic_preferences_2022" class="csl-entry" role="listitem">
Franetovic, Gonzalo, and José Castillo. 2022. <span>“Preferences for Income Redistribution in Unequal Contexts: <span>Changes</span> in Latin America Between 2008 and 2018.”</span> <em>Frontiers in Sociology</em> 7. <a href="https://doi.org/10.3389/fsoc.2022.806458">https://doi.org/10.3389/fsoc.2022.806458</a>.
</div>
<div id="ref-goni_fiscal_2011" class="csl-entry" role="listitem">
Goñi, Eduardo, J. Humberto López, and Luis Servén. 2011. <span>“Fiscal Redistribution and Income Inequality in Latin America.”</span> <em>World Development</em> 39 (9): 1558–69. <a href="https://doi.org/10.1016/j.worlddev.2011.04.025">https://doi.org/10.1016/j.worlddev.2011.04.025</a>.
</div>
<div id="ref-gonthier_parallel_2016" class="csl-entry" role="listitem">
Gonthier, Frédéric. 2016. <span>“Parallel Publics? <span>Support</span> for Income Redistribution in Times of Economic Crisis.”</span> <em>European Journal of Political Research</em> 56 (1): 92–114. <a href="https://doi.org/10.1111/1475-6765.12168">https://doi.org/10.1111/1475-6765.12168</a>.
</div>
<div id="ref-hauk_corruption_2017" class="csl-entry" role="listitem">
Hauk, Esther, Margarita Oviedo, and Xavier Ramos. 2017. <span>“Perception of Corruption and Public Support for Redistribution in Latin America.”</span> <em>SSRN Electronic Journal</em>. <a href="https://doi.org/10.2139/ssrn.2998963">https://doi.org/10.2139/ssrn.2998963</a>.
</div>
<div id="ref-justino_redistributive_2019" class="csl-entry" role="listitem">
Justino, Patricia, and Bruno Martorano. 2019. <span>“Redistributive Preferences and Protests in Latin America.”</span> <em>Journal of Conflict Resolution</em> 63 (9): 2128–54. <a href="https://doi.org/10.1177/0022002719827370">https://doi.org/10.1177/0022002719827370</a>.
</div>
<div id="ref-kuziemko_elastic_2015" class="csl-entry" role="listitem">
Kuziemko, Ilyana, Michael Norton, Emmanuel Saez, and Stefanie Stantcheva. 2015. <span>“How Elastic Are Preferences for Redistribution? <span>Evidence</span> from Randomized Survey Experiments.”</span> <em>American Economic Review</em> 105 (4): 1478–508. <a href="https://doi.org/10.1257/aer.20130360">https://doi.org/10.1257/aer.20130360</a>.
</div>
<div id="ref-lasarga_mobility_2022" class="csl-entry" role="listitem">
Lasarga, Eduardo, and Marcel Leiter. 2022. <span>“Mobility Prospects and Preferences for Redistribution in Latin America.”</span> <em>Econom<span>í</span>a</em> 45 (90): 1–30. <a href="https://doi.org/10.18800/economia.202202.001">https://doi.org/10.18800/economia.202202.001</a>.
</div>
<div id="ref-meuleman_context_2019" class="csl-entry" role="listitem">
Meuleman, Bart. 2019. <span>“The Economic Context of Solidarity. <span>Period</span> Vs. Cohort Differences in Support for Income Redistribution in Britain and the United States.”</span> <em>European Societies</em> 21 (5): 774–801. <a href="https://doi.org/10.1080/14616696.2019.1616792">https://doi.org/10.1080/14616696.2019.1616792</a>.
</div>
<div id="ref-mustofa_education_2023" class="csl-entry" role="listitem">
Mustofa, Mochammad, Cahyadi Sugiyanto, and Andy Susamto. 2023. <span>“Do Education and Religiosity Affect Redistribution Preferences?”</span> <em>Jurnal Cakrawala Pendidikan</em> 42 (1). <a href="https://doi.org/10.21831/cp.v42i1.53109">https://doi.org/10.21831/cp.v42i1.53109</a>.
</div>
<div id="ref-ocampo_social_2018" class="csl-entry" role="listitem">
Ocampo, José Antonio, and Natalia Gómez-Arteaga. 2018. <span>“Social Protection Systems, Redistribution, and Growth in Latin America.”</span> <em>Cepal Review</em> 122: 7–30. <a href="https://doi.org/10.18356/6eb4de51-en">https://doi.org/10.18356/6eb4de51-en</a>.
</div>
<div id="ref-rueda_food_2018" class="csl-entry" role="listitem">
Rueda, David. 2018. <span>“Food Comes First, Then Morals: <span>Redistribution</span> Preferences, Parochial Altruism, and Immigration in Western Europe.”</span> <em>The Journal of Politics</em> 80 (1): 225–39. <a href="https://doi.org/10.1086/694201">https://doi.org/10.1086/694201</a>.
</div>
<div id="ref-yamamura_norms_2015" class="csl-entry" role="listitem">
Yamamura, Eiji. 2015. <span>“Norm for Redistribution, Social Capital, and Perceived Tax Burden: <span>Comparison</span> Between High- and Low-Income Households.”</span> <em>Review of Economics and Institutions</em> 6 (2): 27. <a href="https://doi.org/10.5202/rei.v6i2.184">https://doi.org/10.5202/rei.v6i2.184</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>